# ğŸŒ è¯­è¨€æ£€æµ‹é‡å®šå‘ Demo

è¿™ä¸ª Demo å±•ç¤ºäº†å¦‚ä½•åœ¨ Edge Middleware ä¸­æ ¹æ®æµè§ˆå™¨è¯­è¨€è‡ªåŠ¨é‡å®šå‘åˆ°ä¸åŒçš„è¯­è¨€é¡µé¢ã€‚

## ğŸ“ é¡¹ç›®ç»“æ„

```
my-app-latest/
â”œâ”€â”€ middleware.ts              # è¯­è¨€æ£€æµ‹ä¸­é—´ä»¶
â””â”€â”€ src/app/
    â”œâ”€â”€ zh/
    â”‚   â””â”€â”€ page.tsx          # ä¸­æ–‡é¡µé¢
    â””â”€â”€ en/
        â””â”€â”€ page.tsx          # è‹±æ–‡é¡µé¢
```

## ğŸš€ åŠŸèƒ½è¯´æ˜

### ä¸­é—´ä»¶åŠŸèƒ½
- âœ… æ£€æµ‹æµè§ˆå™¨çš„ `Accept-Language` è¯·æ±‚å¤´
- âœ… è§£æè¯­è¨€ä¼˜å…ˆçº§ï¼ˆæ”¯æŒ quality å€¼ï¼‰
- âœ… è‡ªåŠ¨é‡å®šå‘åˆ°å¯¹åº”è¯­è¨€é¡µé¢
- âœ… é¿å…æ— é™é‡å®šå‘å¾ªç¯
- âœ… ä¿ç•™ URL æŸ¥è¯¢å‚æ•°

### æ”¯æŒçš„è¯­è¨€
- ğŸ‡¨ğŸ‡³ ä¸­æ–‡ (zh, zh-CN, zh-TW, zh-HK)
- ğŸ‡ºğŸ‡¸ è‹±æ–‡ (en, en-US, en-GB) - é»˜è®¤è¯­è¨€

## ğŸ§ª æµ‹è¯•æ–¹æ³•

### æ–¹æ³• 1: ä¿®æ”¹æµè§ˆå™¨è¯­è¨€è®¾ç½®

**Chrome/Edge:**
1. æ‰“å¼€ `chrome://settings/languages`
2. ç‚¹å‡»"æ·»åŠ è¯­è¨€"
3. å°†ä¸­æ–‡æˆ–è‹±æ–‡æ‹–åˆ°æœ€ä¸Šæ–¹
4. åˆ·æ–°é¡µé¢æµ‹è¯•

**Firefox:**
1. æ‰“å¼€ `about:preferences#general`
2. åœ¨"è¯­è¨€"éƒ¨åˆ†ç‚¹å‡»"è®¾ç½®"
3. è°ƒæ•´è¯­è¨€é¡ºåº
4. åˆ·æ–°é¡µé¢æµ‹è¯•

### æ–¹æ³• 2: ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·

**Chrome DevTools:**
1. æŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·
2. ç‚¹å‡»å³ä¸Šè§’ä¸‰ä¸ªç‚¹ â†’ More tools â†’ Network conditions
3. å–æ¶ˆå‹¾é€‰ "Use browser default"
4. åœ¨ User agent ä¸‹æ–¹é€‰æ‹©è‡ªå®šä¹‰è¯­è¨€
5. åˆ·æ–°é¡µé¢æµ‹è¯•

**æµ‹è¯•ç”¨çš„ Accept-Language å€¼:**
```
ä¸­æ–‡: zh-CN,zh;q=0.9,en;q=0.8
è‹±æ–‡: en-US,en;q=0.9
```

### æ–¹æ³• 3: ä½¿ç”¨ curl å‘½ä»¤è¡Œæµ‹è¯•

```bash
# æµ‹è¯•ä¸­æ–‡é‡å®šå‘
curl -I -H "Accept-Language: zh-CN,zh;q=0.9" http://localhost:3000/

# æµ‹è¯•è‹±æ–‡é‡å®šå‘
curl -I -H "Accept-Language: en-US,en;q=0.9" http://localhost:3000/

# æµ‹è¯•æ— è¯­è¨€å¤´ï¼ˆé»˜è®¤è‹±æ–‡ï¼‰
curl -I http://localhost:3000/
```

### æ–¹æ³• 4: ä½¿ç”¨æµè§ˆå™¨æ‰©å±•

æ¨èå®‰è£…: **Locale Switcher** (Chrome/Edge)
- å¯ä»¥å¿«é€Ÿåˆ‡æ¢æµè§ˆå™¨è¯­è¨€è€Œä¸éœ€è¦æ”¹è®¾ç½®

## ğŸ“Š å·¥ä½œæµç¨‹

```
ç”¨æˆ·è®¿é—® /
    â†“
middleware æ£€æµ‹ Accept-Language
    â†“
â”œâ”€ zh-CN â†’ é‡å®šå‘åˆ° /zh
â””â”€ en-US â†’ é‡å®šå‘åˆ° /en
    â†“
æ˜¾ç¤ºå¯¹åº”è¯­è¨€çš„é¡µé¢
```

## ğŸ” Accept-Language ç¤ºä¾‹

```
zh-CN,zh;q=0.9,en;q=0.8,en-US;q=0.7
â”‚     â”‚         â”‚       â””â”€ è´¨é‡å€¼ 0.7
â”‚     â”‚         â””â”€ è´¨é‡å€¼ 0.8
â”‚     â””â”€ è´¨é‡å€¼ 0.9
â””â”€ è´¨é‡å€¼ 1.0 (é»˜è®¤)

ä¼˜å…ˆçº§: zh-CN > zh > en > en-US
```

## ğŸ¯ å®é™…åº”ç”¨åœºæ™¯

1. **å›½é™…åŒ–ç½‘ç«™**: æ ¹æ®ç”¨æˆ·è¯­è¨€è‡ªåŠ¨è·³è½¬åˆ°åˆé€‚çš„è¯­è¨€ç‰ˆæœ¬
2. **åœ°åŒºå†…å®¹**: ä¸ºä¸åŒåœ°åŒºç”¨æˆ·å±•ç¤ºå®šåˆ¶å†…å®¹
3. **A/B æµ‹è¯•**: åŸºäºè¯­è¨€è¿›è¡ŒåŠŸèƒ½æµ‹è¯•
4. **ç”¨æˆ·ä½“éªŒ**: å‡å°‘ç”¨æˆ·æ‰‹åŠ¨é€‰æ‹©è¯­è¨€çš„æ­¥éª¤

## âš™ï¸ è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹ matcher åŒ¹é…æ›´å¤šè·¯å¾„

```typescript
export const config = {
  matcher: [
    '/',
    '/about',
    '/products/:path*',  // åŒ¹é…æ‰€æœ‰ /products ä¸‹çš„è·¯å¾„
  ],
}
```

### æ·»åŠ æ›´å¤šè¯­è¨€æ”¯æŒ

```typescript
function detectLanguage(acceptLanguage: string): 'zh' | 'en' | 'ja' | 'ko' {
  // æ—¥è¯­
  if (languages.some(lang => lang.code.startsWith('ja'))) {
    return 'ja';
  }
  
  // éŸ©è¯­
  if (languages.some(lang => lang.code.startsWith('ko'))) {
    return 'ko';
  }
  
  // ä¸­æ–‡
  if (languages.some(lang => lang.code.startsWith('zh'))) {
    return 'zh';
  }
  
  // é»˜è®¤è‹±æ–‡
  return 'en';
}
```

## ğŸ› è°ƒè¯•

åœ¨æ§åˆ¶å°æŸ¥çœ‹æ—¥å¿—:
```
ğŸŒ Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
ğŸ“ Current path: /
âœ… Detected language: zh
ğŸ”€ Redirecting to: /zh
```

## ğŸ“ æ³¨æ„äº‹é¡¹

1. âš ï¸ é¿å…åœ¨ `/zh` å’Œ `/en` è·¯å¾„ä¸‹å†æ¬¡è§¦å‘é‡å®šå‘ï¼ˆå·²å¤„ç†ï¼‰
2. ğŸ’¡ é»˜è®¤ä½¿ç”¨ 302 ä¸´æ—¶é‡å®šå‘ï¼ŒSEO å‹å¥½
3. ğŸ”„ æ”¯æŒä¿ç•™ URL æŸ¥è¯¢å‚æ•°
4. ğŸŒ å¯æ‰©å±•æ”¯æŒæ›´å¤šè¯­è¨€

## ğŸ¨ é¡µé¢æ ·å¼

- ä¸­æ–‡é¡µé¢: çº¢è‰²ä¸»é¢˜ ğŸ‡¨ğŸ‡³
- è‹±æ–‡é¡µé¢: è“è‰²ä¸»é¢˜ ğŸ‡ºğŸ‡¸
- ä½¿ç”¨ Tailwind CSS å“åº”å¼è®¾è®¡
- åŒ…å«è¯­è¨€åˆ‡æ¢é“¾æ¥

---

**å¼€å‘è€…**: Vincent  
**æ—¥æœŸ**: 2025-11-28  
**æ¡†æ¶**: Next.js 15 + Edge Runtime
